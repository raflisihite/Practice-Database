/* MENAMPILKAN MEMBER YANG SUDAH TERVALIDASI */
SELECT * FROM MEMBER 
WHERE VALIDASI='Tervalidasi';

/* MENAMPILKAN MEMBER YANG BELUM TERVALIDASI */
SELECT * FROM MEMBER
WHERE VALIDASI='Tidak Valid';

/*  MENAMPILKAN TRANSAKSI YANG TELAH DIBAYAR */
SELECT * FROM TRANSAKSI 
WHERE STATUS='Lunas';

/* MENAMPILKAN TRANSAKSI YANG BELUM DIBAYAR */
SELECT * FROM TRANSAKSI 
WHERE STATUS='Tidak Lunas';

/* MENAMPILKAN RIWAYAT TRANSAKSI OLEH MEMBER TERTENTU */
SELECT id_produk,harga,status FROM PRODUK
NATURAL JOIN TRANSAKSI
NATURAL JOIN MEMBER
WHERE id_member='0401_Sultan';

/* MENAMPILKAN CUSTOMER SERVICE YANG MENGHANDLE TRANSAKSI OLEH USER TERTENTU */
SELECT nama_user,id_transaksi,nama_cs FROM TRANSAKSI
NATURAL JOIN MEMBER
NATURAL JOIN CUSTOMER_SERVICE
WHERE id_member ='0401_Sultan';

/* MENAMPILKAN MEMBER YANG MELAKUKAN TRANSAKSI PULSA */
SELECT nama_user,id_transaksi,id_produk,harga,provider FROM TRANSAKSI
NATURAL JOIN MEMBER
NATURAL JOIN PRODUK
NATURAL JOIN PULSA
WHERE id_produk LIKE 'P%';

/* MENAMPILKAN PRODUK PULSA DENGAN NOMINAL PALING KECIL */
SELECT ID_PRODUK,PROVIDER,NOMINAL,HARGA FROM PULSA
NATURAL JOIN PRODUK
WHERE NOMINAL=(SELECT MIN(NOMINAL) FROM PULSA);

/* MENAMPILKAN DATA USER, CUSTOMER SERVICE UNTUK TRANSAKSI YANG HARGANYA LEBIH BESAR DARI RATA-RATA HARGA DI PRODUK */
SELECT ID_TRANSAKSI,NAMA_USER||' Ditangani oleh '||NAMA_CS AS KETERANGAN,HARGA FROM TRANSAKSI
NATURAL JOIN MEMBER
NATURAL JOIN PRODUK
NATURAL JOIN CUSTOMER_SERVICE
WHERE HARGA>(SELECT AVG(HARGA) FROM PRODUK)
ORDER BY TO_NUMBER(HARGA) DESC;

/* MENAMPILKAN DETAIL DATA PRODUK DARI TABEL PRODUK */
SELECT ID_PRODUK,PROVIDER,KATEGORISUB,KATEGORITOP_UP,JUDUL,HARGA FROM PRODUK
LEFT  OUTER JOIN GAMECODE     USING(id_produk)
LEFT  OUTER JOIN PULSA        USING(id_produk)
LEFT  OUTER JOIN SUBSCRIPTION USING(id_produk)
LEFT  OUTER JOIN TOP_UP       USING(id_produk);


/* MENAMPILKAN DATA DETAIL PRODUK YANG BELUM TERBELI DI TRANSAKSI */
SELECT ID_PRODUK,PROVIDER,KATEGORISUB,KATEGORITOP_UP,JUDUL,HARGA FROM PRODUK
LEFT  OUTER JOIN GAMECODE     USING(id_produk)
LEFT  OUTER JOIN PULSA        USING(id_produk)
LEFT  OUTER JOIN SUBSCRIPTION USING(id_produk)
LEFT  OUTER JOIN TOP_UP       USING(id_produk)
WHERE ID_PRODUK<>ALL(SELECT DISTINCT(ID_PRODUK) FROM TRANSAKSI); 

/* MENAMPILKAN DATA DETAIL PRODUK YANG TELAH TERBELI DI TRANSAKSI */
SELECT ID_PRODUK,PROVIDER,KATEGORISUB,KATEGORITOP_UP,JUDUL,HARGA FROM PRODUK
LEFT  OUTER JOIN GAMECODE     USING(id_produk)
LEFT  OUTER JOIN PULSA        USING(id_produk)
LEFT  OUTER JOIN SUBSCRIPTION USING(id_produk)
LEFT  OUTER JOIN TOP_UP       USING(id_produk)
WHERE ID_PRODUK IN (SELECT DISTINCT(ID_PRODUK) FROM TRANSAKSI WHERE STATUS='Lunas');

/* TOTAL PENDAPATAN DARI HASIL TRANSAKSI */
SELECT SUM(HARGA) AS "TOTAL PENDAPATAN" FROM TRANSAKSI
NATURAL JOIN PRODUK
WHERE STATUS='Lunas';


